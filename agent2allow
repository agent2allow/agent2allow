#!/usr/bin/env bash
set -euo pipefail

ROOT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

case "${1:-}" in
  doctor)
    shift
    exec "$ROOT_DIR/scripts/doctor.sh" "$@"
    ;;
  policy-diff)
    shift
    exec python3 "$ROOT_DIR/gateway/scripts/policy_diff.py" "$@"
    ;;
  *)
    echo "Usage:"
    echo "  ./agent2allow doctor [--json] [--strict]"
    echo "  ./agent2allow policy-diff <old-policy.yml> <new-policy.yml> [--json] [--strict]"
    exit 1
    ;;
esac
